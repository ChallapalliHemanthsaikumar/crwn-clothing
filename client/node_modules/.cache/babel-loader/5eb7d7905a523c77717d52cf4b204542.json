{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/hemanth/Desktop/e-commerce/some/crwn-clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/hemanth/Desktop/e-commerce/some/crwn-clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(signInAfterSignUp),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(emailSignInStart),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutstart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,all,call}from\"@redux-saga/core/effects\";import UserActionTypes from'./user.types';import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from'../../firebase/firebase.utils';import{googleSignInSuccess,googleSignInFailure,emailSignInSuccess,emailSignInFailure,signoutSuccess,signoutFailure,signUpSuccess,signUpFailure}from\"./user.action\";export function signInWithGoogle(){var _yield$auth$signInWit,user,userRef,userSnapshot;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context.sent;user=_yield$auth$signInWit.user;_context.next=7;return call(createUserProfileDocument,user);case 7:userRef=_context.sent;_context.next=10;return userRef.get();case 10:userSnapshot=_context.sent;_context.next=13;return put(googleSignInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 13:_context.next=19;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](0);_context.next=19;return put(googleSignInFailure(_context.t0));case 19:case\"end\":return _context.stop();}}},_marked,null,[[0,15]]);}export function signUp(_ref){var _ref$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password,displayName=_ref$payload.displayName;_context2.prev=1;_context2.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context2.sent;user=_yield$auth$createUse.user;_context2.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);_context2.next=14;return put(signUpFailure(_context2.t0));case 14:case\"end\":return _context2.stop();}}},_marked2,null,[[1,10]]);}export function signInAfterSignUp(_ref2){var _ref2$payload,user,additionalData,userRef,userSnapshot;return _regeneratorRuntime.wrap(function signInAfterSignUp$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref2$payload=_ref2.payload,user=_ref2$payload.user,additionalData=_ref2$payload.additionalData;_context3.prev=1;_context3.next=4;return call(createUserProfileDocument,user,additionalData);case 4:userRef=_context3.sent;_context3.next=7;return userRef.get();case 7:userSnapshot=_context3.sent;_context3.next=10;return put(emailSignInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 10:_context3.next=16;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](1);_context3.next=16;return put(signUpFailure(_context3.t0));case 16:case\"end\":return _context3.stop();}}},_marked3,null,[[1,12]]);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context4.stop();}}},_marked4);}export function isUserAuthenticated(){var userAuth,userRef,userSnapshot;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return getCurrentUser();case 3:userAuth=_context5.sent;if(userAuth){_context5.next=6;break;}return _context5.abrupt(\"return\");case 6:_context5.next=8;return call(createUserProfileDocument,userAuth);case 8:userRef=_context5.sent;_context5.next=11;return userRef.get();case 11:userSnapshot=_context5.sent;_context5.next=14;return put(googleSignInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 14:_context5.next=20;break;case 16:_context5.prev=16;_context5.t0=_context5[\"catch\"](0);_context5.next=20;return put(emailSignInFailure(_context5.t0));case 20:case\"end\":return _context5.stop();}}},_marked5,null,[[0,16]]);}export function signInWithEmail(_ref3){var _ref3$payload,email,password,_yield$auth$signInWit2,user,userRef,userSnapshot;return _regeneratorRuntime.wrap(function signInWithEmail$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_ref3$payload=_ref3.payload,email=_ref3$payload.email,password=_ref3$payload.password;_context6.prev=1;_context6.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context6.sent;user=_yield$auth$signInWit2.user;_context6.next=8;return call(createUserProfileDocument,user);case 8:userRef=_context6.sent;_context6.next=11;return userRef.get();case 11:userSnapshot=_context6.sent;_context6.next=14;return put(emailSignInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 14:_context6.next=20;break;case 16:_context6.prev=16;_context6.t0=_context6[\"catch\"](1);_context6.next=20;return put(emailSignInFailure(_context6.t0));case 20:case\"end\":return _context6.stop();}}},_marked6,null,[[1,16]]);}export function emailSignInStart(){return _regeneratorRuntime.wrap(function emailSignInStart$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context8.stop();}}},_marked8);}export function onSignOutstart(){return _regeneratorRuntime.wrap(function onSignOutstart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context9.stop();}}},_marked9);}export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;_context10.next=3;return auth.signOut();case 3:_context10.next=5;return put(signoutSuccess());case 5:_context10.next=11;break;case 7:_context10.prev=7;_context10.t0=_context10[\"catch\"](0);_context10.next=11;return put(signoutFailure(_context10.t0));case 11:case\"end\":return _context10.stop();}}},_marked10,null,[[0,7]]);}export function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context11.stop();}}},_marked11);}export function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignUp);case 2:case\"end\":return _context12.stop();}}},_marked12);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return all([call(onGoogleSignInStart),call(emailSignInStart),call(onCheckUserSession),call(onSignOutstart),call(onSignUpStart),call(onSignUpSuccess)]);case 2:case\"end\":return _context13.stop();}}},_marked13);}","map":{"version":3,"sources":["C:/Users/hemanth/Desktop/e-commerce/some/crwn-clothing/client/src/redux/user/user-sagas.js"],"names":["signInWithGoogle","signUp","signInAfterSignUp","onGoogleSignInStart","isUserAuthenticated","signInWithEmail","emailSignInStart","onCheckUserSession","onSignOutstart","signOut","onSignUpStart","onSignUpSuccess","userSagas","takeLatest","put","all","call","UserActionTypes","auth","googleProvider","createUserProfileDocument","getCurrentUser","googleSignInSuccess","googleSignInFailure","emailSignInSuccess","emailSignInFailure","signoutSuccess","signoutFailure","signUpSuccess","signUpFailure","signInWithPopup","user","userRef","get","userSnapshot","id","data","payload","email","password","displayName","createUserWithEmailAndPassword","additionalData","GOOGLE_SIGN_IN_START","userAuth","signInWithEmailAndPassword","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","SIGN_OUT_START","SIGN_UP_START","SIGN_UP_SUCCESS"],"mappings":"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","sourcesContent":["import { takeLatest, put,all ,call  } from \"@redux-saga/core/effects\";\r\n\r\nimport  UserActionTypes from './user.types';\r\nimport { auth, googleProvider , createUserProfileDocument,getCurrentUser} from '../../firebase/firebase.utils';\r\n\r\nimport { googleSignInSuccess,googleSignInFailure,emailSignInSuccess,emailSignInFailure,signoutSuccess,signoutFailure,signUpSuccess,signUpFailure } from \"./user.action\";\r\n\r\nexport function* signInWithGoogle(){\r\n    try{\r\n\r\n        const { user } = yield auth.signInWithPopup(googleProvider);\r\n        const userRef =  yield call(createUserProfileDocument, user);\r\n\r\n        const userSnapshot = yield userRef.get();\r\n        yield put(googleSignInSuccess({id: userSnapshot.id, ...userSnapshot.data()}))\r\n\r\n        } catch (error){\r\n            yield put(googleSignInFailure(error));\r\n\r\n    }\r\n}\r\n\r\nexport function*  signUp({payload: {email,password,displayName}}){\r\n    try{\r\n        const {  user } = yield auth.createUserWithEmailAndPassword(\r\n            email,\r\n            password\r\n        );\r\n        yield put(signUpSuccess({user,additionalData:{displayName}}))\r\n    }catch(error){\r\n       yield  put(signUpFailure(error))\r\n\r\n    }\r\n}\r\n\r\nexport function* signInAfterSignUp({payload:{user,additionalData}}){\r\n    try{\r\n        \r\n        const userRef =  yield call(createUserProfileDocument, user,additionalData);\r\n\r\n        const userSnapshot = yield userRef.get();\r\n        yield put(emailSignInSuccess({id: userSnapshot.id, ...userSnapshot.data()}))\r\n\r\n    }catch(error){\r\n        yield put(signUpFailure(error))\r\n    }\r\n\r\n}\r\n\r\nexport function* onGoogleSignInStart(){\r\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle)\r\n\r\n}\r\n\r\n\r\nexport function* isUserAuthenticated(){\r\n    try{\r\n        const userAuth = yield getCurrentUser();\r\n        if(!userAuth) return;\r\n        const userRef =  yield call(createUserProfileDocument, userAuth);\r\n\r\n        const userSnapshot = yield userRef.get();\r\n        yield put(googleSignInSuccess({id: userSnapshot.id, ...userSnapshot.data()}))\r\n\r\n    }catch(error){\r\n        yield put(emailSignInFailure(error));\r\n\r\n    }\r\n}\r\n\r\nexport function* signInWithEmail({payload:{email,password}}){\r\n    try{\r\n        const { user } = yield auth.signInWithEmailAndPassword(email, password);\r\n        const userRef =  yield call(createUserProfileDocument, user);\r\n\r\n        const userSnapshot = yield userRef.get();\r\n        yield put(emailSignInSuccess({id: userSnapshot.id, ...userSnapshot.data()}))\r\n\r\n\r\n    }catch(error){\r\n        yield put(emailSignInFailure(error))\r\n    }\r\n\r\n\r\n}\r\n\r\nexport function* emailSignInStart(){\r\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail)\r\n}\r\n\r\nexport function* onCheckUserSession(){\r\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION, isUserAuthenticated);\r\n\r\n}\r\n\r\nexport function* onSignOutstart() {\r\n    yield takeLatest(UserActionTypes.SIGN_OUT_START, signOut);\r\n}\r\n\r\nexport function*  signOut() {\r\n    try{\r\n        yield auth.signOut();\r\n        yield (put(signoutSuccess()))\r\n    }catch(err){\r\n        yield put(signoutFailure(err));\r\n\r\n    }\r\n}\r\n\r\n\r\nexport function* onSignUpStart(){\r\n    yield takeLatest(UserActionTypes.SIGN_UP_START, signUp)\r\n}\r\n\r\nexport function* onSignUpSuccess(){\r\n    yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS, signInAfterSignUp)\r\n}\r\n\r\nexport function* userSagas(){\r\n    yield all([call(onGoogleSignInStart),call(emailSignInStart),call(onCheckUserSession),call(onSignOutstart),call(onSignUpStart),call(onSignUpSuccess)]);\r\n}"]},"metadata":{},"sourceType":"module"}